# mail-sender

Программа для массовой рассылки электронных писем с различным содержимым

![main](https://github.com/MisterFuntikov/mail-sender/assets/69751509/41864e63-bcd1-4e38-9b7e-3ed0d7485f6d)


## 1. Настройка программы

Для работы программы рядом с исполняемым файлом необходимо хранить файл `config.json`. Файл обязательно должен содержать ключ `smtp` в котором указываются параметры подключения к почтовому серверу через smtp протокол. 

Допустимые параметры smtp, которые указываются в файле:

| Ключ | Описание | По умолчанию |
|-|-|-|
| host | адрес почтового сервера | 
| port | порт для подключения | 25
| user | логин подключения | user
| password | пароль для подключения | 


Дополнительно в файле можно указать другие параметры, которые будут автоматически применены при запуске программы:
| Ключ | Описание | По умолчанию |
|-|-|-|
| default_folder | папка по умолчанию при выборе файлов | Текущая папка с программой
| use_ssl | использовать зашифрованное подключение к почтовому серверу | no
| save_log | сохранять лог файлы | no
| use_subfolders | просматривать вложенные папки при поиске файлов для рассылки | no
| check_mail | проверять почтовые ящики на корректность перед рассылкой | no
| mail_separator | символы разделителя почтовых ящиков, при указании нескольких символов необходимо использовать символ « \| » | «; \|;\|, \|,»
| duplicate_to_sender | дублировать письмо на адрес отправителя | no

## 2. Меню программы

- Поле Параметры: указывается файл с расширением `.xlsx` с параметрами рассылки. Файл должен содержать названия столбцов в строке 1. 
  - Столбец с именем ID указывает на уникальное имя строки при рассылке. На основе этого столбца ищутся файлы по маске `{ID}_*.*`
  - Столбец `Title` содержит тему письма.
  - Столбец `ToEmail` содержит кому будет направлено письмо.
  - Столбец `FromEmail` содержит от кого будет направлено письмо.

![изображение](https://github.com/MisterFuntikov/mail-sender/assets/69751509/f2ed4b26-dea0-4dac-856f-2e58ec865e48)

- Поле Тело письма: указывается файл с расширением .html, .htm с  содержанием почтового сообщения.
- Метод рассылки:
  - разные файлы по разным адресам — будет искать файлы из папки по маске `{ID}_*.*`, если файл подходит, то он будет прикреплен к письму;
  - один файл всем адресам — будет прикреплен один указанный файл ко всем почтовым сообщениям.
- Настройка Включать вложенные папки
  - выключена: будет искать файлы только в текущей указанной директории,
  - включено: если директория содержит в себе вложенные папки, то будет пытаться искать файлы ещё и в них.
- Настройка Сохранять журнал о работе — если включено, то сохраняет журнал работы программы рядом с программой с именем `sendlog_%datetime%.txt`.
- Настройка Проверять почту перед отправкой — если включено, проверяет почту из столбцов ToEmail и FromEmail на ошибки.
- Настройка Не отсылать если нет вложений — если включено, то письмо не будет направлено если к строке с именем ID не найдутся файлы в директории.
- Настройка Дублировать письмо на адрес отправителя — если включено, то будет отсылать письмо не только на адрес ToEmail, но и на адрес FromEmail.
- Настройка Использовать SSL – если включено, то пытается подключиться к почтовому серверу через зашифрованное подключение.
  


  



